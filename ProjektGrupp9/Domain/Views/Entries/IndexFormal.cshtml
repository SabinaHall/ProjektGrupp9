@using Microsoft.AspNet.Identity
@model DataLogic.Models.TagEntryViewModel


<h2>Formella inlägg</h2>

<p>
    @Html.ActionLink("Skriv nytt inlägg", "CreateTest", new { Id = User.Identity.GetUserId() }, htmlAttributes: new { @class = "btn btn-default" })
</p>

@foreach (var entry in Model.Entries.Reverse())
{
    <div class="well">
        <h3>@entry.Heading</h3>
        <p>Skriven av: @entry.Author.Email</p>
        <p>Datum: @entry.Date.ToString()</p>
        <br />
        <br />
        <p>@entry.text</p>
        <br />

        @if (entry.File != null && entry.ContentType.Contains("image"))
        {
            <img height="300" width="300" src="@Url.Action("EntryFile", new { Id = entry.Id })" />
        }
        else if (entry.File != null && !entry.ContentType.Contains("image"))
        {
            <p>Klicka på länken för att se bifogad fil</p>
            @Html.ActionLink("Bifogad fil: " + entry.Filename.ToString(), "EntryFile", "Entries", routeValues: new { Id = entry.Id }, htmlAttributes: null);
        }

        <br />
        <br />

        @using (var db = new DataLogic.Models.ApplicationDbContext())
        {
            foreach (var hej in db.EntryTagEntries)
            {
                foreach (var helo in Model.Tags)
                {
                    if (hej.EntryId == entry.Id)
                    {
                        <p>@helo.TagName</p>
                    }
                }
            }
        }


        <br />
        <br />
        <br />
        @if (entry.Author.Id == User.Identity.GetUserId() || User.IsInRole("SuperAdmin") || User.IsInRole("Admin"))
        {
            @Html.ActionLink("Radera inlägg", "Delete", new { id = entry.Id }, new { @class = "btn btn-default" })
        }

    </div>
}


<div class="clearfix"></div>
